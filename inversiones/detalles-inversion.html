<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght@300;400;500;600;700" rel="stylesheet" />
    <title>Confirmar Inversión - MEA</title>
    <script>
    tailwind.config = {
        darkMode: "class",
        theme: {
            extend: {
                colors: {
                    "primary": "#EA5B2B",
                    "primary-dark": "#C74A21",
                    "primary-light": "#F15A29"
                }
            }
        }
    }
</script>

<style>
    * { -webkit-tap-highlight-color: transparent; box-sizing: border-box; }
    body { font-family: 'Inter', sans-serif; background: #f9fafb; }
    .material-symbols-outlined { font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24; }
    .glass { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(20px) saturate(180%); }
    .dark .glass { background: rgba(42, 42, 40, 0.95); }
    
    @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
    .animate-slide-in { animation: slideIn 0.4s ease; }
    .animate-pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
    
    input[type="range"] {
        -webkit-appearance: none;
        appearance: none;
        background: transparent;
        cursor: pointer;
        width: 100%;
    }

    input[type="range"]::-webkit-slider-track {
        background: #e5e7eb;
        height: 0.5rem;
        border-radius: 0.5rem;
    }

    input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        background: #EA5B2B;
        height: 1.5rem;
        width: 1.5rem;
        border-radius: 50%;
        border: 3px solid white;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        margin-top: -0.5rem;
    }

    .payment-method { transition: all 0.3s ease; }
    .payment-method.selected { border-color: #EA5B2B; background: rgba(234, 91, 43, 0.05); }
</style>

</head>
<body>
    <!-- Header -->
<header class="fixed top-0 left-0 right-0 z-50 px-4 py-3 glass border-b border-gray-200/50 dark:border-gray-700/50">
    <div class="flex items-center gap-3">
        <button onclick="goBack()" class="flex h-9 w-9 items-center justify-center rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
            <span class="material-symbols-outlined text-gray-800 dark:text-gray-200">arrow_back</span>
        </button>
        <div>
            <h1 class="text-gray-900 dark:text-gray-100 text-lg font-bold">Confirmar Inversión</h1>
            <p class="text-gray-500 text-xs">Paso 2 de 3</p>
        </div>
    </div>
</header>

<!-- Contenido -->
<main class="pt-16 pb-32 px-4 max-w-2xl mx-auto">
    <div class="space-y-6 py-6">

        <!-- Resumen de inversión -->
        <div class="animate-slide-in bg-white dark:bg-gray-800 rounded-2xl shadow-sm overflow-hidden">
            <div class="p-4 border-b border-gray-200 dark:border-gray-700">
                <h2 class="text-gray-900 dark:text-gray-100 text-base font-bold">Resumen de Inversión</h2>
            </div>
            <div class="p-4 space-y-3">
                <div class="flex items-start gap-3">
                    <div class="w-16 h-16 rounded-xl bg-cover bg-center flex-shrink-0" style="background-image: url('https://images.unsplash.com/photo-1600596542815-ffad4c1539a9?w=400&q=80');"></div>
                    <div class="flex-1 min-w-0">
                        <h3 class="text-gray-900 dark:text-gray-100 text-sm font-bold mb-1">Casa Residencial Downtown</h3>
                        <p class="text-gray-500 text-xs mb-2">San Francisco, CA</p>
                        <div class="flex items-center gap-2">
                            <span class="px-2 py-1 rounded-md bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 text-xs font-bold">14.2% ROI</span>
                            <span class="px-2 py-1 rounded-md bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 text-xs font-bold">18 meses</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Monto de inversión -->
        <div class="animate-slide-in bg-white dark:bg-gray-800 rounded-2xl shadow-sm p-6" style="animation-delay: 0.1s;">
            <h2 class="text-gray-900 dark:text-gray-100 text-base font-bold mb-4">Monto a Invertir</h2>
            
            <div class="mb-4">
                <div class="flex items-baseline justify-center mb-2">
                    <span class="text-gray-500 text-2xl mr-2">$</span>
                    <input 
                        type="number" 
                        id="investmentAmount"
                        value="85000"
                        min="50000"
                        max="500000"
                        step="5000"
                        class="text-center text-4xl font-black text-primary bg-transparent border-none focus:outline-none w-48"
                        oninput="updateInvestment()"
                    />
                </div>
                <p class="text-center text-gray-500 text-xs">Mínimo: $50,000 -  Máximo: $500,000</p>
            </div>

            <input 
                type="range" 
                id="investmentRange"
                min="50000"
                max="500000"
                step="5000"
                value="85000"
                class="w-full mb-4"
                oninput="updateInvestmentFromRange()"
            />

            <!-- Proyección -->
            <div class="p-4 bg-gradient-to-br from-primary/5 to-primary-dark/5 rounded-xl border border-primary/20">
                <div class="flex items-center justify-between mb-2">
                    <span class="text-gray-600 dark:text-gray-400 text-sm">Retorno proyectado</span>
                    <span class="text-gray-900 dark:text-gray-100 text-base font-bold">$<span id="projectedReturn">12,070</span></span>
                </div>
                <div class="flex items-center justify-between">
                    <span class="text-gray-600 dark:text-gray-400 text-sm">Total al vencimiento</span>
                    <span class="text-primary text-xl font-black">$<span id="totalReturn">97,070</span></span>
                </div>
            </div>
        </div>

        <!-- Método de pago -->
        <div class="animate-slide-in bg-white dark:bg-gray-800 rounded-2xl shadow-sm p-6" style="animation-delay: 0.2s;">
            <h2 class="text-gray-900 dark:text-gray-100 text-base font-bold mb-4">Método de Pago</h2>
            
            <div class="space-y-3 mb-4">
                <button onclick="selectPaymentMethod('card')" class="payment-method w-full flex items-center gap-4 p-4 rounded-xl border-2 border-gray-200 dark:border-gray-700 text-left hover:border-primary transition-all" data-method="card">
                    <div class="flex h-12 w-12 items-center justify-center rounded-xl bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400">
                        <span class="material-symbols-outlined">credit_card</span>
                    </div>
                    <div class="flex-1">
                        <p class="text-gray-900 dark:text-gray-100 text-sm font-bold">Tarjeta de crédito/débito</p>
                        <p class="text-gray-500 text-xs">Visa, Mastercard, American Express</p>
                    </div>
                    <span class="material-symbols-outlined text-gray-400 text-2xl hidden check-icon">check_circle</span>
                </button>

                <button onclick="selectPaymentMethod('bank')" class="payment-method selected w-full flex items-center gap-4 p-4 rounded-xl border-2 border-primary bg-primary/5 text-left hover:border-primary transition-all" data-method="bank">
                    <div class="flex h-12 w-12 items-center justify-center rounded-xl bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400">
                        <span class="material-symbols-outlined">account_balance</span>
                    </div>
                    <div class="flex-1">
                        <p class="text-gray-900 dark:text-gray-100 text-sm font-bold">Transferencia bancaria</p>
                        <p class="text-gray-500 text-xs">Transferencia directa desde tu banco</p>
                    </div>
                    <span class="material-symbols-outlined text-primary text-2xl check-icon" style="font-variation-settings: 'FILL' 1;">check_circle</span>
                </button>

                <button onclick="selectPaymentMethod('crypto')" class="payment-method w-full flex items-center gap-4 p-4 rounded-xl border-2 border-gray-200 dark:border-gray-700 text-left hover:border-primary transition-all" data-method="crypto">
                    <div class="flex h-12 w-12 items-center justify-center rounded-xl bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400">
                        <span class="material-symbols-outlined">currency_bitcoin</span>
                    </div>
                    <div class="flex-1">
                        <p class="text-gray-900 dark:text-gray-100 text-sm font-bold">Criptomonedas</p>
                        <p class="text-gray-500 text-xs">Bitcoin, Ethereum, USDT</p>
                    </div>
                    <span class="material-symbols-outlined text-gray-400 text-2xl hidden check-icon">check_circle</span>
                </button>
            </div>

            <!-- Formulario de tarjeta -->
            <div id="cardForm" class="hidden space-y-4 p-4 bg-gray-50 dark:bg-gray-900 rounded-xl">
                <div>
                    <label class="block text-gray-700 dark:text-gray-300 text-xs font-semibold mb-2">Número de tarjeta</label>
                    <input type="text" placeholder="1234 5678 9012 3456" maxlength="19" class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-sm focus:outline-none focus:border-primary" />
                </div>
                <div class="grid grid-cols-2 gap-3">
                    <div>
                        <label class="block text-gray-700 dark:text-gray-300 text-xs font-semibold mb-2">Vencimiento</label>
                        <input type="text" placeholder="MM/AA" maxlength="5" class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-sm focus:outline-none focus:border-primary" />
                    </div>
                    <div>
                        <label class="block text-gray-700 dark:text-gray-300 text-xs font-semibold mb-2">CVV</label>
                        <input type="text" placeholder="123" maxlength="4" class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-sm focus:outline-none focus:border-primary" />
                    </div>
                </div>
                <div>
                    <label class="block text-gray-700 dark:text-gray-300 text-xs font-semibold mb-2">Nombre en la tarjeta</label>
                    <input type="text" placeholder="John Doe" class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-sm focus:outline-none focus:border-primary" />
                </div>
            </div>

            <!-- Formulario de transferencia -->
            <div id="bankForm" class="space-y-4 p-4 bg-gray-50 dark:bg-gray-900 rounded-xl">
                <div class="p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg">
                    <p class="text-blue-900 dark:text-blue-300 text-xs font-semibold mb-2">Datos bancarios para transferencia:</p>
                    <div class="space-y-1 text-xs text-blue-800 dark:text-blue-400">
                        <p><strong>Banco:</strong> MEA Financial Services</p>
                        <p><strong>Cuenta:</strong> 1234-5678-9012-3456</p>
                        <p><strong>CLABE:</strong> 012345678901234567</p>
                        <p><strong>Beneficiario:</strong> MEA Inversiones S.A.</p>
                    </div>
                </div>
                <p class="text-gray-600 dark:text-gray-400 text-xs">
                    Realiza la transferencia y sube tu comprobante para procesar tu inversión
                </p>
                <button onclick="uploadReceipt()" class="w-full flex items-center justify-center gap-2 px-4 py-3 rounded-lg border-2 border-dashed border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-400 hover:border-primary hover:text-primary transition-all">
                    <span class="material-symbols-outlined">upload_file</span>
                    <span class="text-sm font-semibold">Subir comprobante</span>
                </button>
            </div>

            <!-- Formulario de crypto -->
            <div id="cryptoForm" class="hidden space-y-4 p-4 bg-gray-50 dark:bg-gray-900 rounded-xl">
                <div>
                    <label class="block text-gray-700 dark:text-gray-300 text-xs font-semibold mb-2">Selecciona criptomoneda</label>
                    <select class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-sm focus:outline-none focus:border-primary">
                        <option>Bitcoin (BTC)</option>
                        <option>Ethereum (ETH)</option>
                        <option>Tether (USDT)</option>
                        <option>USD Coin (USDC)</option>
                    </select>
                </div>
                <div class="p-4 bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg text-center">
                    <p class="text-orange-900 dark:text-orange-300 text-xs font-semibold mb-2">Dirección de wallet:</p>
                    <p class="text-orange-800 dark:text-orange-400 text-sm font-mono break-all">1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa</p>
                    <button onclick="copyWallet()" class="mt-3 px-4 py-2 rounded-lg bg-orange-600 text-white text-xs font-bold hover:bg-orange-700 transition-all">
                        Copiar dirección
                    </button>
                </div>
                <p class="text-gray-600 dark:text-gray-400 text-xs text-center">
                    Envía el monto exacto en la criptomoneda seleccionada
                </p>
            </div>
        </div>

        <!-- Términos y condiciones -->
        <div class="animate-slide-in" style="animation-delay: 0.3s;">
            <label class="flex items-start gap-3 cursor-pointer">
                <input type="checkbox" id="termsCheckbox" class="mt-1 w-5 h-5 text-primary rounded focus:ring-primary focus:ring-2" onchange="toggleConfirmButton()" />
                <div>
                    <p class="text-gray-700 dark:text-gray-300 text-sm">
                        Acepto los <a href="#" class="text-primary font-semibold hover:underline">términos y condiciones</a> y la <a href="#" class="text-primary font-semibold hover:underline">política de privacidad</a>
                    </p>
                    <p class="text-gray-500 text-xs mt-1">
                        También acepto recibir actualizaciones sobre mi inversión
                    </p>
                </div>
            </label>
        </div>

        <!-- Advertencia de riesgo -->
        <div class="animate-slide-in p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-xl" style="animation-delay: 0.4s;">
            <div class="flex gap-3">
                <span class="material-symbols-outlined text-yellow-600 dark:text-yellow-400 flex-shrink-0">warning</span>
                <div>
                    <p class="text-gray-900 dark:text-gray-100 text-sm font-bold mb-1">Advertencia de Riesgo</p>
                    <p class="text-gray-600 dark:text-gray-400 text-xs leading-relaxed">
                        Las inversiones inmobiliarias conllevan riesgos. El rendimiento pasado no garantiza resultados futuros. Invierte solo lo que puedas permitirte perder.
                    </p>
                </div>
            </div>
        </div>

    </div>
</main>

<!-- Bottom Action Bar -->
<div class="fixed bottom-0 left-0 right-0 z-50 px-6 py-4 glass border-t border-gray-200/50">
    <button onclick="confirmInvestment()" id="confirmBtn" disabled class="w-full flex items-center justify-center gap-2 px-6 py-4 rounded-xl bg-gray-300 text-gray-500 font-bold cursor-not-allowed transition-all">
        <span class="material-symbols-outlined">lock</span>
        <span>Confirmar Inversión</span>
    </button>
</div>

<!-- Modal de procesamiento -->
<div id="processingModal" class="hidden fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4">
    <div class="bg-white dark:bg-gray-800 rounded-3xl p-8 max-w-sm w-full text-center">
        <div class="w-20 h-20 rounded-full bg-primary/10 flex items-center justify-center mx-auto mb-4">
            <span class="material-symbols-outlined text-primary text-5xl animate-pulse">payments</span>
        </div>
        <h3 class="text-gray-900 dark:text-gray-100 text-xl font-bold mb-2">Procesando inversión</h3>
        <p class="text-gray-600 dark:text-gray-400 text-sm mb-6">Por favor espera mientras procesamos tu inversión...</p>
        <div class="h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
            <div id="progressBar" class="h-full bg-gradient-to-r from-primary to-primary-dark transition-all duration-500" style="width: 0%"></div>
        </div>
    </div>
</div>

<script>
    let selectedPayment = 'bank';
    const ROI = 0.142;
    const TERM_MONTHS = 18;

    function updateInvestment() {
        const amount = parseInt(document.getElementById('investmentAmount').value);
        document.getElementById('investmentRange').value = amount;
        calculateReturns(amount);
    }

    function updateInvestmentFromRange() {
        const amount = parseInt(document.getElementById('investmentRange').value);
        document.getElementById('investmentAmount').value = amount;
        calculateReturns(amount);
    }

    function calculateReturns(amount) {
        const years = TERM_MONTHS / 12;
        const projectedReturn = amount * ROI * years;
        const totalReturn = amount + projectedReturn;

        document.getElementById('projectedReturn').textContent = Math.round(projectedReturn).toLocaleString();
        document.getElementById('totalReturn').textContent = Math.round(totalReturn).toLocaleString();
    }

    function selectPaymentMethod(method) {
        selectedPayment = method;

        // Actualizar botones
        document.querySelectorAll('.payment-method').forEach(btn => {
            const checkIcon = btn.querySelector('.check-icon');
            if (btn.dataset.method === method) {
                btn.classList.add('selected', 'border-primary', 'bg-primary/5');
                btn.classList.remove('border-gray-200', 'dark:border-gray-700');
                checkIcon.classList.remove('hidden', 'text-gray-400');
                checkIcon.classList.add('text-primary');
                checkIcon.style.fontVariationSettings = "'FILL' 1";
            } else {
                btn.classList.remove('selected', 'border-primary', 'bg-primary/5');
                btn.classList.add('border-gray-200', 'dark:border-gray-700');
                checkIcon.classList.add('hidden', 'text-gray-400');
                checkIcon.classList.remove('text-primary');
                checkIcon.style.fontVariationSettings = "'FILL' 0";
            }
        });

        // Mostrar/ocultar formularios
        document.getElementById('cardForm').classList.add('hidden');
        document.getElementById('bankForm').classList.add('hidden');
        document.getElementById('cryptoForm').classList.add('hidden');

        if (method === 'card') {
            document.getElementById('cardForm').classList.remove('hidden');
        } else if (method === 'bank') {
            document.getElementById('bankForm').classList.remove('hidden');
        } else if (method === 'crypto') {
            document.getElementById('cryptoForm').classList.remove('hidden');
        }
    }

    function uploadReceipt() {
        showToast('Abriendo selector de archivos...');
    }

    function copyWallet() {
        navigator.clipboard.writeText('1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa');
        showToast('Dirección copiada al portapapeles ✓');
    }

    function toggleConfirmButton() {
        const checkbox = document.getElementById('termsCheckbox');
        const confirmBtn = document.getElementById('confirmBtn');

        if (checkbox.checked) {
            confirmBtn.disabled = false;
            confirmBtn.classList.remove('bg-gray-300', 'text-gray-500', 'cursor-not-allowed');
            confirmBtn.classList.add('bg-gradient-to-r', 'from-primary', 'to-primary-dark', 'text-white', 'shadow-lg', 'hover:scale-105');
            confirmBtn.querySelector('.material-symbols-outlined').textContent = 'payments';
        } else {
            confirmBtn.disabled = true;
            confirmBtn.classList.add('bg-gray-300', 'text-gray-500', 'cursor-not-allowed');
            confirmBtn.classList.remove('bg-gradient-to-r', 'from-primary', 'to-primary-dark', 'text-white', 'shadow-lg', 'hover:scale-105');
            confirmBtn.querySelector('.material-symbols-outlined').textContent = 'lock';
        }
    }

    function confirmInvestment() {
        const amount = document.getElementById('investmentAmount').value;
        
        // Mostrar modal de procesamiento
        document.getElementById('processingModal').classList.remove('hidden');
        
        // Simular progreso
        let progress = 0;
        const progressBar = document.getElementById('progressBar');
        const interval = setInterval(() => {
            progress += 10;
            progressBar.style.width = progress + '%';
            
            if (progress >= 100) {
                clearInterval(interval);
                setTimeout(() => {
                    window.location.href = 'investment-success.html?amount=' + amount;
                }, 500);
            }
        }, 300);
    }

    function goBack() {
        window.history.back();
    }

    function showToast(message) {
        const toast = document.createElement('div');
        toast.className = 'fixed bottom-28 left-1/2 -translate-x-1/2 px-6 py-3 rounded-full glass shadow-2xl text-gray-900 dark:text-gray-100 text-sm font-semibold z-50';
        toast.textContent = message;
        document.body.appendChild(toast);
        
        setTimeout(() => {
            toast.classList.add('opacity-0', 'transition-opacity');
            setTimeout(() => toast.remove(), 300);
        }, 2500);
    }

    // Inicialización
    document.addEventListener('DOMContentLoaded', () => {
        if (localStorage.getItem('darkMode') === 'true') {
            document.documentElement.classList.add('dark');
        }
        calculateReturns(85000);
    });
</script>

</body>
</html>